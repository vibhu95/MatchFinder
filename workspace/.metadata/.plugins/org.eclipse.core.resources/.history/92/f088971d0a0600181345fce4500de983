package com.classes;

import java.sql.*;
import java.io.*;
public class UserDAO {
	static Connection con = null;
	public static UserBean insert(UserBean b){
		int result;
		try{
		con = ConnectionCon.getConnection();
		String sql="insert into agents(name,age_of_agent,age_of_business,email,address,password,contact,latitude,longitude) values(?,?,?,?,?)";
	    PreparedStatement ps = con.prepareStatement(sql);
	    ps.setString(1,b.getName());
	    ps.setInt(2,b.getAge_of_agent());
	    ps.setInt(3,b.getAge_of_Business());
	    ps.setString(4,b.getEmail());
	    ps.setString(5,b.getAddress());
	    ps.setString(6,b.getPassword());
	    ps.setLong(7,b.getContact());
	    ps.setDouble(8,b.getLat());
	    ps.setDouble(9,b.getLan());
	    
	    result = ps.executeUpdate();
	    
		if(result > 0){
	    	b.setMsg("Successfully inserted");
	    	b.setStatus(1);
	    }
	    else
	    {
	    	b.setMsg("Failed... Try Again");
	    	b.setStatus(0);
	    }
    
		}
		catch(Exception e){
			System.out.println(e);
		}
		finally{	
			if(con!=null){
			con = null;
			}
		}
		return b;
	}
}
