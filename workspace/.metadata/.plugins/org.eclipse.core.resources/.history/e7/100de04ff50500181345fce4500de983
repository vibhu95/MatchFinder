package com.classes;

import java.sql.*;
import java.io.*;
public class UserDAO {
	static Connection con = null;
	public static UserBean insert(UserBean b){
		int result;
		try{
		con = ConnectionCon.getConnection();
	    String sql="insert into agents(name,age_of_agent,age_of_business,email,address,password,contact,latitude,longitude) values(?,?,?,?,?)";
	    PreparedStatement ps = con.prepareStatement(sql);
	    ps.setString(1,b.getName());
	    ps.setInt(2,b.getAge_of_agent());
	    ps.setInt(3,b.getAge_of_Business());
	    ps.setString(4,b.getEmail());
	    ps.setString(5,b.getAddress());
	    ps.setString(6,b.getPassword());
	    ps.setInt(7,b.getContact());
	    ps.setDouble(8,b.getLat());
	    ps.setDouble(9,b.getLan());
	    
	    result = ps.executeUpdate();
		}
		catch(Exception e){
			System.out.println(e);
		}
		finally{
			if(con!=null|con!=""){
			con = null;
			}
		}
		return b;
	}
    public static UserBean update(UserBean b){
    		int result;
    		try{
    		con = ConnectionCon.getConnection();
    	    String sql="update agents(name,age_of_agent,age_of_business,email,address,password,contact,latitude,longitude) values(?,?,?,?,?) where id="+b.getId()+";
    	    PreparedStatement ps = con.prepareStatement(sql);
    	    ps.setString(1,b.getName());
    	    ps.setInt(2,b.getAge_of_agent());
    	    ps.setInt(3,b.getAge_of_Business());
    	    ps.setString(4,b.getEmail());
    	    ps.setString(5,b.getAddress());
    	    ps.setString(6,b.getPassword());
    	    ps.setInt(7,b.getContact());
    	    ps.setDouble(8,b.getLat());
    	    ps.setDouble(9,b.getLan());
    	    
    	    result = ps.executeUpdate();
    		}
    		catch(Exception e){
    			System.out.println(e);
    		}
    		finally{
    			if(con!=null|con!=""){
    			con = null;
    			}
    		}
    			return b;
	}
    
    
    public static UserBean select(UserBean b){
		
    	try{
    	    con = ConnectionCon.getConnection();
    	    String sql="select * from agents where email="+b.getName()+" and password="+b.getPassword();
    	    Statement ps = con.createStatement(sql);
    	    ResultSet rs = ps.executeQuery();
    	     if(rs.hasNext()){
    	 	    while(rs.next())
    		    {
    		    	b.setId(rs.getInt("agent_id"));
    		    	b.setName(rs.getString("name"));
    		    	b.setAge_of_agent(rs.getString("age_of_agent"));
    		    	b.setAge_of_Business(rs.getString("age_of_business"));
    		    	b.setEmail(rs.getString("email"));
    		    	b.setAddress(rs.getString("address"));
    		    	b.setPassword(rs.getString("password"));
    		    	b.setDp(rs.getBlob("dp"));
    		    	b.setSub_amt(rs.getInt("sub_amt"));
    		    	b.setContact(rs.getString("contact"));
    		    	b.setLat(rs.getString("latitude"));
    		    	b.setLan(rs.getString("longitude"));
    		    	b.setStatus(rs.getInt("status"));
    		        b.setMsg("Sucessfully logged In ");
    		  	   	    }
    	       }
    	     else{
    	    	 b.setMsg("Not available");
    	     }
     		}
    		catch(Exception e){
    			System.out.println(e);
    		}
    		finally{
    			if(con!=null|con!=""){
    			con = null;
    			}
    		}
    		
    	return b;
	}
    
    
    public static UserBean delete(UserBean b){
		
		
		
		
		return b;
	}
	
	
	

}
